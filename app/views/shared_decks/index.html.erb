<% content_for :title, "Shared Decks" %>
<% content_for :page_title, "Shared Decks" %>
<% content_for :page_actions do %>
  <%= link_to new_shared_deck_path, class: "btn-primary inline-flex items-center gap-1.5" do %>
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
    </svg>
    Share a Deck
  <% end %>
<% end %>

<div class="max-w-6xl mx-auto space-y-6">
  <%# Search bar %>
  <%= form_with url: shared_decks_path, method: :get, local: true, class: "relative" do |form| %>
    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
      </svg>
    </div>
    <%= form.text_field :q, value: params[:q], placeholder: "Search shared decks...", class: "form-input w-full pl-10" %>
  <% end %>

  <%# Category filter pills %>
  <div class="flex items-center gap-2 flex-wrap">
    <%= link_to "All", shared_decks_path,
        class: params[:category].blank? ? "pill-active" : "pill-inactive" %>
    <% @categories.each do |category| %>
      <%= link_to category, shared_decks_path(category: category),
          class: params[:category] == category ? "pill-active" : "pill-inactive" %>
    <% end %>
  </div>

  <%# Sort options %>
  <div class="flex items-center gap-4 text-sm">
    <span class="text-gray-500">Sort by:</span>
    <%= link_to "Popular", shared_decks_path(sort: "popular", category: params[:category], q: params[:q]),
        class: (params[:sort].blank? || params[:sort] == "popular") ? "font-medium text-blue-600 hover:text-blue-700" : "text-gray-500 hover:text-gray-700" %>
    <%= link_to "Top Rated", shared_decks_path(sort: "top_rated", category: params[:category], q: params[:q]),
        class: params[:sort] == "top_rated" ? "font-medium text-blue-600 hover:text-blue-700" : "text-gray-500 hover:text-gray-700" %>
    <%= link_to "Newest", shared_decks_path(sort: "newest", category: params[:category], q: params[:q]),
        class: params[:sort] == "newest" ? "font-medium text-blue-600 hover:text-blue-700" : "text-gray-500 hover:text-gray-700" %>
  </div>

  <%# Featured section %>
  <% if @featured.any? %>
    <div>
      <h2 class="text-lg font-semibold text-gray-900 mb-3">Featured Decks</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <% @featured.each do |deck| %>
          <%= render "shared_decks/deck_card", deck: deck %>
        <% end %>
      </div>
    </div>
  <% end %>

  <%# All decks grid %>
  <div>
    <h2 class="text-lg font-semibold text-gray-900 mb-3">All Decks</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <% @shared_decks.each do |deck| %>
        <%= render "shared_decks/deck_card", deck: deck %>
      <% end %>
    </div>
  </div>

  <%# Pagination %>
  <%== pagy_nav(@pagy) if @pagy.pages > 1 %>
</div>
